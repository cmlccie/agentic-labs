# Agentic Labs - Copilot Instructions

## Project Overview

This is an educational repository for experimenting with LLMs and agentic AI patterns.

## Instruction Files

The following instruction files contain specific rules for modifying or creating code in different parts of the repository:

| File                                                    | Applies To                 | Description                            |
| ------------------------------------------------------- | -------------------------- | -------------------------------------- |
| `.github/instructions/agentic_labs.instructions.md`     | `src/agentic_labs/**/*.py` | Guidelines for core library code       |
| `.github/instructions/lab.instructions.md`              | `labs/**/*.md`             | Guidelines for lab documentation       |
| `.github/instructions/lab_code.instructions.md`         | `labs/**/*.py`             | Guidelines for lab code                |
| `.github/instructions/containerization.instructions.md` | `**/Dockerfile`            | Docker containerization best practices |
| `.github/instructions/github_actions.instructions.md`   | `.github/workflows/*.yml`  | GitHub Actions workflow patterns       |

## Learning Labs

Each directory in `labs/` contains a self-contained lab focused on a specific aspect of working with LLMs and agentic AI patterns. Each lab includes:

- A `README.md` file with detailed instructions that guide the user through the lab exercises.
- One or more Python scripts that implement the lab exercises.

## Style Guidelines

### List Style Guidelines

- All items in a list should be consistently structured (either simple phrases or complete sentences).
- When a list contains sentences, each sentence should end with a period.
- When a list contains simple phrases, do not use periods.
- Maintain parallel structure across all items in the same list.

## Key Architectural Patterns

### Dependency Management & Script Execution

- Use `uv` (not `pip` or `poetry`) for all package management.
- Dependencies defined in `pyproject.toml`, locked in `uv.lock`.
- Scripts should have a shebang line at the top and be executable.
- Always run commands via `uv run <relative-path-to-script>` from the repository root directory.

### Code Organization

- Shared utilities in `src/agentic_labs/` (installable package).
- Executable labs in `labs/` subdirectories.
- Each lab has its own README with specific instructions.

### Logging System (`src/agentic_labs/logging.py`)

- Three logging modes:
  - `colorized_config()` - Simple colored output without timestamps.
  - `fancy_config()` - Full formatting with timestamps and log levels.
  - `silent_config()` - Disables logging output entirely.

## Critical Implementation Details

### Message Format Consistency

All chat interfaces use OpenAI-compatible message format:

```python
messages = [
    {"role": "system", "content": "system prompt"},
    {"role": "user", "content": "user input"},
    {"role": "assistant", "content": "model response"}
]
```

## Avoid

- Don't use `pip install` - always use `uv sync`.

## User Tools

- The repository includes command-line interface (CLI) tool contained in the `agentic_labs` package for user interaction.
- Use `typer` for command-line interfaces (CLIs).
- Organize the CLI code in the `agentic_labs.cli` package.
- Organize CLI commands under a main `cli` Typer app instance contained in `agentic_labs.cli.main`.
- Each CLI command should be defined in its own module within the `agentic_labs.cli` package.

## Developer Tools

### Makefile

The `Makefile` in the repository root provides common developer (contributor) operations. Use `make help` to see all available targets and their descriptions.

The Makefile is for **developer (contributor) operations only**. User operations (running labs) should follow the instructions in lab README files using `uv run` commands.

When adding new development tools or changing project structure, update the Makefile accordingly. The Makefile uses a dynamic help system - add new targets with `## Description` comments to automatically include them in the help output.

## Containerization & Deployment

### Docker/Container Images

- Use multi-stage builds when appropriate for smaller production images.
- Base images should use Alpine Linux variants when possible for smaller size (e.g., `python:3.13-alpine`).
- Use `requirements.txt` generated by `uv export` for container dependency management.
- Set working directory to `/app` in containers.
- Make scripts executable with `chmod +x` in Dockerfile.
- Use `ENTRYPOINT` for the main command and `CMD` for default arguments.
- Expose appropriate ports (e.g., `EXPOSE 8000` for HTTP services).
- Follow patterns established in `labs/weather-agent/weather-mcp-server/Dockerfile`.

### GitHub Actions Workflows

- Place workflows in `.github/workflows/` directory with descriptive names.
- Use `build-<service-name>.yml` naming convention for container build workflows.
- Trigger workflows on:
  - Push to `main` branch with path filters for relevant directories
  - Pull requests to `main` branch with path filters
  - Release events (`types: [published]`)
- Use GitHub Container Registry (`ghcr.io`) for hosting images.
- Follow semantic versioning for image tags:
  - `type=ref,event=branch` for branch builds
  - `type=ref,event=pr` for PR builds
  - `type=semver,pattern={{version}}` for releases
  - `type=semver,pattern={{major}}.{{minor}}` for releases
  - `type=semver,pattern={{major}}` for releases
  - `type=sha,prefix={{branch}}-` for commit-specific tags
  - `type=raw,value=latest,enable={{is_default_branch}}` for latest tag
- Include build attestations for supply chain security.
- Use multi-platform builds (`linux/amd64,linux/arm64`) when possible.
- Enable GitHub Actions caching (`cache-from: type=gha`, `cache-to: type=gha,mode=max`).
- Use proper permissions:
  ```yaml
  permissions:
    contents: read
    packages: write
    id-token: write
    attestations: write
  ```
- Follow patterns established in `.github/workflows/build-weather-mcp-server.yml`.
